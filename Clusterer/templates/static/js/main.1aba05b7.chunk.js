(this.webpackJsonpfront=this.webpackJsonpfront||[]).push([[0],{238:function(e,t,n){e.exports=n(380)},243:function(e,t,n){},244:function(e,t,n){},380:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),s=n(89),i=n.n(s),l=(n(243),n(244),n(91)),u=n(13),c=n(33),o=n(17),d=n(9),m={allDimensions:[],chosenDimensions:[0,1]},f={clustersWithRawData:[],numOfRetainedClusters:{value:10,bufferValue:10,valid:!0}},p={clustersOnRaw:null,unclusteredRaw:null,clusteredRaw:null,scales:null},h=Object(o.b)({dimensions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_DIMENSIONS":return Object(d.a)(Object(d.a)({},e),{},{allDimensions:t.payload});case"UPDATE_CHOSEN_DIMENSIONS":return Object(d.a)(Object(d.a)({},e),{},{chosenDimensions:t.payload});default:return e}},clusters:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_CLUSTERS":return Object(d.a)(Object(d.a)({},e),{},{clustersWithRawData:t.payload});case"UPDATE_NUM_OF_RETAINED_CLUSTERS":return Object(d.a)(Object(d.a)({},e),{},{numOfRetainedClusters:t.payload});default:return e}},scatters:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CLUSTERS_ON_RAW":case"RESET_CLUSTERS_ON_RAW":return Object(d.a)(Object(d.a)({},e),{},{clustersOnRaw:t.payload});case"SET_UNCLUSTERED_RAW":return Object(d.a)(Object(d.a)({},e),{},{unclusteredRaw:t.payload});case"SET_CLUSTERED_RAW":return Object(d.a)(Object(d.a)({},e),{},{clusteredRaw:t.payload});case"SET_SCALES":return Object(d.a)(Object(d.a)({},e),{},{scales:t.payload});default:return e}}}),O=Object(o.d)(h,Object(o.c)(window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__())),S=n(19),E=n.n(S),v=n(191),R=n(14),b=n(192),g=function(e){var t=e.data,n=e.variables;return r.a.createElement(b.a,{data:t,variables:n,lineOpacity:.5,colors:{scheme:"dark2"},margin:{top:50,right:60,bottom:50,left:60},animate:!0,motionStiffness:90,motionDamping:12})},y=n(30),w=n(74);function D(e,t){t=JSON.parse(JSON.stringify(t));return Object.keys(t).forEach((function(n){t[n].forEach((function(a,r){var s={};e.map((function(e,t){s[e]=a[t]})),t[n][r]=s,s={}}))})),t}function N(e,t){if(2!==e.length)throw new Error("not 2 dimensional");var n=e[0],a=e[1];if(null==t)return[];var r=t.raw_data,s=r.map((function(e){return e[n]})),i=r.map((function(e){return e[a]})),l=[];return s.map((function(e,t){l.push({x:e,y:i[t]})})),{id:"raw_data",data:l}}function _(e,t){if(2!==e.length)throw new Error("not 2 dimensional");var n=e[0],a=e[1],r=[];if(null==t)return[];var s=t.all_clusters,i=t.raw_data,l=Array.from(new Set(s)).sort();-1==l[0]&&(l.shift(),l.push(-1));var u,c=Object(y.a)(l);try{for(c.s();!(u=c.n()).done;){var o,d=u.value,m=[],f=0,p=Object(y.a)(s);try{for(p.s();!(o=p.n()).done;){o.value==d&&m.push({x:i[f][n],y:i[f][a]}),f+=1}}catch(O){p.e(O)}finally{p.f()}f=0;var h="";h=0==d?"largest_cluster":-1==d?"noise":d+". cluster",r.push({id:h,data:m})}}catch(O){c.e(O)}finally{c.f()}return r}function j(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;if(2!==e.length)throw new Error("not 2 dimensional");var r=e[0],s=e[1];n=null==n?{id:"microclusters",data:[]}:n;var i,l=t.cluster.map((function(e){return t.raw_data[e]})),u=l.map((function(e){return e[r]})),c=l.map((function(e){return e[s]})),o=u.length,d=u.reduce((function(e,t){return e+t}),0),m=c.reduce((function(e,t){return e+t}),0),f=d*d+m*m,p=Math.pow(d/o,2),h=Math.pow(m/o,2),O=Math.sqrt(f/o-p),S=Math.sqrt(f/o-h),E=parseInt(Math.max(O,S)),v=parseInt(d/o),R=parseInt(m/o),b=n.data.reduce((function(e,t){return t.radius+e}),0)/n.data.length;n.data.forEach((function(e){return e.normalizedRadius=e.radius/b}));var g=E/(b||E);i={x:v,y:R,radius:E,normalizedRadius:g};var y=n.data.map((function(e){return JSON.stringify(e)})),w=JSON.stringify(i);return-1!==y.indexOf(w)||(n.data.length>=a&&n.data.shift(),n.data.push(i)),n}function C(e,t){return e.map((function(e){return t[e]}))}function x(e,t){if(2!=t.length)throw new Error("length of dimension must be 2");var n=e.data,a=n.map((function(e){return e.x})),r=n.map((function(e){return e.y})),s=Object(w.mean)(a),i=Object(w.mean)(r),l=Object(w.standardDeviation)(a),u=Object(w.standardDeviation)(r);return{xScaleMin:s-5*l,xScaleMax:s+5*l,yScaleMin:i-5*u,yScaleMax:i+5*u}}function M(e,t){var n=Object(a.useRef)();Object(a.useEffect)((function(){n.current=e}),[e]),Object(a.useEffect)((function(){if(null!==t){var e=setInterval((function(){n.current()}),t);return function(){return clearInterval(e)}}}),[t])}function T(e,t,n){var a=t.cluster.map((function(e){return t.raw_data[e]}));return e.length>=n.value?(e.shift(),e.push(a)):e.push(a),e}function U(e,t){3==(e=e.replace(/^\s*#|\s*$/g,"")).length&&(e=e.replace(/(.)/g,"$1$1"));var n=parseInt(e.substr(0,2),16),a=parseInt(e.substr(2,2),16),r=parseInt(e.substr(4,2),16);return"#"+(0|256+n+(256-n)*t/100).toString(16).substr(1)+(0|256+a+(256-a)*t/100).toString(16).substr(1)+(0|256+r+(256-r)*t/100).toString(16).substr(1)}var I=n(201),A=function(e){var t=e.data,n=e.nodeSize,a=e.dimNames,s=e.scales,i=e.colors;return i||(i={scheme:"red_blue"}),r.a.createElement(I.a,{data:t,nodeSize:n,margin:{top:60,right:140,bottom:70,left:90},xScale:{type:"linear",min:s.xScaleMin,max:s.xScaleMax},yScale:{type:"linear",min:s.yScaleMin,max:s.yScaleMax},axisTop:null,axisRight:null,colors:i,blendMode:"lighten",axisBottom:{orient:"bottom",tickSize:5,tickPadding:5,tickRotation:0,legend:void 0==a?"X":a[0],legendPosition:"middle",legendOffset:46},axisLeft:{orient:"left",tickSize:5,tickPadding:5,tickRotation:0,legend:void 0==a?"Y":a[1],legendPosition:"middle",legendOffset:-60},legends:[{anchor:"bottom-right",direction:"column",justify:!1,translateX:130,translateY:0,itemWidth:100,itemHeight:12,itemsSpacing:5,itemDirection:"left-to-right",symbolSize:12,symbolShape:"circle",effects:[{on:"hover",style:{itemOpacity:1}}]}]})},k=function(e){return{type:"SET_DIMENSIONS",payload:e}},W=function(e){return{type:"UPDATE_CHOSEN_DIMENSIONS",payload:e}},L=function(e){return{type:"UPDATE_CLUSTERS",payload:e}},z=function(e){return{type:"UPDATE_NUM_OF_RETAINED_CLUSTERS",payload:e}},J=function(e){return{type:"SET_CLUSTERS_ON_RAW",payload:e}},P=function(){return{type:"RESET_CLUSTERS_ON_RAW",payload:null}},V=function(e){return{type:"SET_UNCLUSTERED_RAW",payload:e}},F=function(e){return{type:"SET_CLUSTERED_RAW",payload:e}},X=function(e){return{type:"SET_SCALES",payload:e}};var B=Object(c.b)((function(e){return{numOfRetainedClusters:e.clusters.numOfRetainedClusters}}),(function(e){return Object(o.a)({updateNumOfRetainedClusters:z,resetClustersOnRaw:P},e)}))((function(e){return r.a.createElement("div",{className:"controlPanelWrapper"},r.a.createElement("form",{className:"control-panel"},r.a.createElement("div",{className:"retained-clusters-wrapper"},r.a.createElement("label",{className:"retained-clusters-label"},"Retained Clusters: "),r.a.createElement("input",{type:"retained-clusters",className:"retained-clusters-input",value:e.numOfRetainedClusters.bufferValue,onChange:function(t){var n=t.target.value,a=!0;isNaN(n)||""==n||n<=0?(a=!1,e.updateNumOfRetainedClusters(Object(d.a)(Object(d.a)({},e.numOfRetainedClusters),{},{bufferValue:n,valid:a}))):(n=parseInt(n,10),e.updateNumOfRetainedClusters(Object(d.a)(Object(d.a)({},e.numOfRetainedClusters),{},{bufferValue:n,valid:a})))}})),r.a.createElement("button",{className:"control-submitter",type:"submit",onClick:function(t){t.preventDefault(),e.numOfRetainedClusters.valid?(e.updateNumOfRetainedClusters(Object(d.a)(Object(d.a)({},e.numOfRetainedClusters),{},{value:e.numOfRetainedClusters.bufferValue})),e.resetClustersOnRaw()):e.updateNumOfRetainedClusters(Object(d.a)(Object(d.a)({},e.numOfRetainedClusters),{},{bufferValue:e.numOfRetainedClusters.value,valid:!0}))}},"Update")))}));var $=Object(c.b)((function(e){var t=e.dimensions;return{allDimensions:t.allDimensions,chosenDimensions:t.chosenDimensions}}),(function(e){return Object(o.a)({setDimensions:k,chooseDimensions:W,resetClustersOnRaw:P},e)}))((function(e){return r.a.createElement("div",{className:"dimensionsControlWrapper"},r.a.createElement("div",{className:"choose-dim"},["First Dimension","Second Dimension"].map((function(t,n){return r.a.createElement("div",null,r.a.createElement("span",null,t),r.a.createElement("select",{defaultValue:e.allDimensions[e.chosenDimensions[n]],onChange:function(t){return function(t,n){var a=0===n?[e.allDimensions.indexOf(t.target.value),e.chosenDimensions[1]]:[e.chosenDimensions[0],e.allDimensions.indexOf(t.target.value)];e.chooseDimensions(a),e.resetClustersOnRaw()}(t,n)}},e.allDimensions.map((function(e){return r.a.createElement("option",{value:e}," ",e," ")}))))}))))}));var H=Object(c.b)((function(e){var t=e.dimensions,n=e.clusters,a=e.scatters;return{allDimensions:t.allDimensions,chosenDimensions:t.chosenDimensions,clustersWithRawData:n.clustersWithRawData,clustersOnRaw:a.clustersOnRaw,unclusteredRaw:a.unclusteredRaw,clusteredRaw:a.clusteredRaw,scales:a.scales,numOfRetainedClusters:n.numOfRetainedClusters}}),(function(e){return Object(o.a)({setDimensions:k,chooseDimensions:W,updateClusters:L,setClustersOnRaw:J,resetClustersOnRaw:P,setUnclusteredRaw:V,setClusteredRaw:F,setScales:X,updateNumOfRetainedClusters:z},e)}))((function(e){var t=Object(a.useState)(null),n=Object(R.a)(t,2),s=n[0],i=n[1],l=Object(u.f)().pathname;return M((function(){l="/"==l?"/default":l,fetch("/dataBroker"+l).then((function(e){return e.json()})).then(function(){var t=Object(v.a)(E.a.mark((function t(n){var a,r,s,l;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"!=typeof n||!n.includes("error")||!n.includes("ResourceNotFound")){t.next=2;break}throw new Error("ResourceNotFound");case 2:a=JSON.parse(JSON.parse(n)),e.setDimensions(a.dimensions),L(T(e.clustersWithRawData,a,e.numOfRetainedClusters)),a.cluster=C(a.cluster,a.raw_data),r=D(e.allDimensions,a),i(r),s=JSON.parse(JSON.parse(n)),e.setClustersOnRaw(j(e.chosenDimensions,s,e.clustersOnRaw,e.numOfRetainedClusters.value)),l=N(e.chosenDimensions,s),e.setUnclusteredRaw(l),e.setClusteredRaw(_(e.chosenDimensions,s)),e.setScales(x(l,e.chosenDimensions));case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),500),null==s||null==e.clustersOnRaw||null==e.unclusteredRaw||null==e.scales||e.allDimensions==[]?null:r.a.createElement("div",null,r.a.createElement(B,null),r.a.createElement("div",{className:"category-graph"},r.a.createElement(A,{data:[e.unclusteredRaw,e.clustersOnRaw],nodeSize:function(e){return void 0!=e.normalizedRadius?40*e.normalizedRadius:9},dimNames:e.chosenDimensions.map((function(t){return e.allDimensions[t]})),scales:e.scales})),r.a.createElement("div",{className:"category-graph"},r.a.createElement(A,{data:e.clusteredRaw,dimNames:e.chosenDimensions.map((function(t){return e.allDimensions[t]})),scales:e.scales})),r.a.createElement($,null),["raw_data","cluster"].map((function(t){return r.a.createElement("div",{className:"parallel-graphs"},r.a.createElement(g,{data:s[t],variables:e.allDimensions.map((function(e){return{key:e,type:"linear",legend:e}}))}))})))})),q=n(140);var Y=Object(c.b)((function(e){var t=e.scatters,n=e.clusters,a=e.dimensions;return{scales:t.scales,numOfRetainedClusters:n.numOfRetainedClusters,dimensions:a.allDimensions}}),(function(e){return Object(o.a)({setScales:X,setDimensions:k},e)}))((function(e){var t=Object(a.useState)([]),n=Object(R.a)(t,2),s=n[0],i=n[1],l=Object(a.useState)([]),c=Object(R.a)(l,2),o=c[0],d=c[1],m=Object(a.useState)([]),f=Object(R.a)(m,2),p=f[0],h=f[1],O=Object(u.f)().pathname,S=O.split("/clusters");O="/"==(O=""==S[1]&&2==S.length?"/":S[1])?"/default":O,M((function(){fetch("/clusterBroker"+O).then((function(e){return e.json()})).then((function(t){if("string"==typeof t&&t.includes("error")&&t.includes("ResourceNotFound"))throw new Error("ResourceNotFound");var n=JSON.parse(JSON.parse(t)),a=n.clusters.map((function(e){return{x:e.centroid[0],y:e.centroid[1],radius:e.radius}}));i([{id:"Clusters",data:a}]),v(a),E(a),n.dimensions?e.setDimensions(n.dimensions):e.setDimensions(["First Dimension","Second Dimension"]);for(var r=[],s=0;s<o.length;s++){var l=100*((o.length-s)/(2*o.length)+.5);l=100==l?1:100-l,r.push(U("#C9202C",l))}r.reverse(),h(r)}))}),500);var E=function(t){var n=Object(q.a)(o),a=Object(q.a)(t.sort((function(e,t){return e.radius-t.radius}))).pop();n.some((function(e){return a.x==e.data[0].x&&a.y==e.data[0].y&&a.radius==e.data[0].radius}))||(e.numOfRetainedClusters.value<n.length&&(n=[]),n.length>=e.numOfRetainedClusters.value?(n.shift(),n.push({id:"cluster_"+Math.random().toString(),data:[a]})):n.push({id:"cluster_"+Math.random().toString(),data:[a]}),n.forEach((function(e,t){return e.id=t.toString()+". Cluster"})),d(n))},v=function(t){var n=function(e,t){return e-t},a=t.map((function(e){return e.x})).sort(n),r=t.map((function(e){return e.y})).sort(n);e.scales?e.setScales({xScaleMin:Math.min(a[0],e.scales.xScaleMin),xScaleMax:Math.max(a[a.length-1],e.scales.xScaleMax),yScaleMin:Math.min(r[0],e.scales.yScaleMin),yScaleMax:Math.max(r[r.length-1],e.scales.yScaleMax)}):e.setScales({xScaleMin:a[0],xScaleMax:a[a.length-1],yScaleMin:r[0],yScaleMax:r[r.length-1]})};return s==[]||null==e.scales?null:r.a.createElement("div",null,r.a.createElement(B,null),r.a.createElement("div",{className:"category-graph"},r.a.createElement(A,{data:o,nodeSize:function(e){return e.radius},scales:e.scales,dimNames:e.dimensions,colors:p})),r.a.createElement("div",{className:"category-graph"},r.a.createElement(A,{data:s,nodeSize:function(e){return e.radius},scales:e.scales,dimNames:e.dimensions})))}));var G=function(){return r.a.createElement(c.a,{store:O},r.a.createElement(l.a,null,r.a.createElement("div",{className:"App"},r.a.createElement(u.c,null,r.a.createElement(u.a,{path:"/clusters"},r.a.createElement(Y,null)),r.a.createElement(u.a,{path:"/"},r.a.createElement(H,null))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(G,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[238,1,2]]]);